import{_ as K,B as S,r as n,o as f,c as x,b as l,w as t,e as y,f as U,a as G,i as p,h as z,F as P,C as R,E as T,D as A,n as B}from"./index-362cbba5.js";import{g as H,s as J,d as Q}from"./roomType-45cf62ae.js";import{g as W}from"./dict-a7885ece.js";import"./request-f1d2817d.js";const X={class:"page"},Y={class:"toolbar"},Z={__name:"RoomTypeList",setup(h){const w=y([]),m=y(!1),c=y(null),g=y(!1),V=y([]),b=U({name:"",bedTypeId:null}),o=U({id:null,code:"",name:"",area:null,bedTypeId:null,maxGuests:2,basePrice:null,sortOrder:0}),L={code:[{required:!0,message:"请输入房型编码",trigger:"blur"}],name:[{required:!0,message:"请输入房型名称",trigger:"blur"}],bedTypeId:[{required:!0,message:"请选择床型",trigger:"change"}],maxGuests:[{required:!0,message:"请输入可住人数",trigger:"blur"}],basePrice:[{required:!0,message:"请输入基础价格",trigger:"blur"}]};async function u(){const d=await H(b);w.value=d.list||[]}async function q(){V.value=await W()}function k(d){d?Object.assign(o,{id:d.id,code:d.code,name:d.name,area:d.area,bedTypeId:d.bedTypeId,maxGuests:d.maxGuests,basePrice:d.basePrice,sortOrder:d.sortOrder??0}):C(),m.value=!0}function C(){var d;Object.assign(o,{id:null,code:"",name:"",area:null,bedTypeId:null,maxGuests:2,basePrice:null,sortOrder:0}),(d=c.value)==null||d.resetFields()}async function E(){var d;await((d=c.value)==null?void 0:d.validate().catch(()=>{})),g.value=!0;try{await J(o),T.success("保存成功"),m.value=!1,u()}catch(e){T.error((e==null?void 0:e.message)||"保存失败")}finally{g.value=!1}}async function F(d){await A.confirm("确定删除该房型吗？","提示",{type:"warning"}),await Q(d.id),T.success("删除成功"),u()}return S(async()=>{await q(),await u()}),(d,e)=>{const i=n("el-button"),v=n("el-input"),I=n("el-option"),O=n("el-select"),s=n("el-table-column"),D=n("el-table"),N=n("el-card"),r=n("el-form-item"),_=n("el-input-number"),$=n("el-form"),M=n("el-dialog");return f(),x("div",X,[l(N,null,{header:t(()=>[e[13]||(e[13]=G("span",null,"房型管理",-1)),l(i,{type:"primary",style:{float:"right"},onClick:e[0]||(e[0]=a=>k())},{default:t(()=>[...e[12]||(e[12]=[p("新增房型",-1)])]),_:1})]),default:t(()=>[G("div",Y,[l(v,{modelValue:b.name,"onUpdate:modelValue":e[1]||(e[1]=a=>b.name=a),placeholder:"房型名称",clearable:"",style:{width:"160px"},onKeyup:z(u,["enter"])},null,8,["modelValue"]),l(O,{modelValue:b.bedTypeId,"onUpdate:modelValue":e[2]||(e[2]=a=>b.bedTypeId=a),placeholder:"床型",clearable:"",style:{width:"120px"},onChange:u},{default:t(()=>[(f(!0),x(P,null,R(V.value,a=>(f(),B(I,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(i,{type:"primary",onClick:u},{default:t(()=>[...e[14]||(e[14]=[p("查询",-1)])]),_:1})]),l(D,{data:w.value,border:"",stripe:""},{default:t(()=>[l(s,{prop:"code",label:"房型编码",width:"100"}),l(s,{prop:"name",label:"房型名称",width:"120"}),l(s,{prop:"area",label:"面积(㎡)",width:"90"}),l(s,{prop:"bedTypeName",label:"床型",width:"90"}),l(s,{prop:"maxGuests",label:"可住人数",width:"90"}),l(s,{prop:"basePrice",label:"基础价格(元)",width:"120"}),l(s,{prop:"sortOrder",label:"排序",width:"70"}),l(s,{label:"操作",width:"160",fixed:"right"},{default:t(({row:a})=>[l(i,{link:"",type:"primary",onClick:j=>k(a)},{default:t(()=>[...e[15]||(e[15]=[p("编辑",-1)])]),_:1},8,["onClick"]),l(i,{link:"",type:"danger",onClick:j=>F(a)},{default:t(()=>[...e[16]||(e[16]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),l(M,{modelValue:m.value,"onUpdate:modelValue":e[11]||(e[11]=a=>m.value=a),title:o.id?"编辑房型":"新增房型",width:"500px",onClose:C},{footer:t(()=>[l(i,{onClick:e[10]||(e[10]=a=>m.value=!1)},{default:t(()=>[...e[17]||(e[17]=[p("取消",-1)])]),_:1}),l(i,{type:"primary",loading:g.value,onClick:E},{default:t(()=>[...e[18]||(e[18]=[p("确定",-1)])]),_:1},8,["loading"])]),default:t(()=>[l($,{ref_key:"formRef",ref:c,model:o,rules:L,"label-width":"100px"},{default:t(()=>[l(r,{label:"房型编码",prop:"code"},{default:t(()=>[l(v,{modelValue:o.code,"onUpdate:modelValue":e[3]||(e[3]=a=>o.code=a),placeholder:"如 STD",disabled:!!o.id},null,8,["modelValue","disabled"])]),_:1}),l(r,{label:"房型名称",prop:"name"},{default:t(()=>[l(v,{modelValue:o.name,"onUpdate:modelValue":e[4]||(e[4]=a=>o.name=a),placeholder:"如 标准间"},null,8,["modelValue"])]),_:1}),l(r,{label:"面积(㎡)",prop:"area"},{default:t(()=>[l(_,{modelValue:o.area,"onUpdate:modelValue":e[5]||(e[5]=a=>o.area=a),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(r,{label:"床型",prop:"bedTypeId"},{default:t(()=>[l(O,{modelValue:o.bedTypeId,"onUpdate:modelValue":e[6]||(e[6]=a=>o.bedTypeId=a),placeholder:"请选择",style:{width:"100%"}},{default:t(()=>[(f(!0),x(P,null,R(V.value,a=>(f(),B(I,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"可住人数",prop:"maxGuests"},{default:t(()=>[l(_,{modelValue:o.maxGuests,"onUpdate:modelValue":e[7]||(e[7]=a=>o.maxGuests=a),min:1,max:10,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(r,{label:"基础价格",prop:"basePrice"},{default:t(()=>[l(_,{modelValue:o.basePrice,"onUpdate:modelValue":e[8]||(e[8]=a=>o.basePrice=a),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(r,{label:"排序",prop:"sortOrder"},{default:t(()=>[l(_,{modelValue:o.sortOrder,"onUpdate:modelValue":e[9]||(e[9]=a=>o.sortOrder=a),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},oe=K(Z,[["__scopeId","data-v-be0f9055"]]);export{oe as default};
