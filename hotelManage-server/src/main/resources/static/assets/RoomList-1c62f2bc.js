import{_ as Y,B as Z,r as n,o as d,c as f,b as o,w as t,e as p,f as F,a as j,i as s,F as _,C as V,h,t as K,n as y,G as ee,E as C,D as le}from"./index-fddec7dd.js";import{g as oe,a as te,s as ae,u as ue,d as de}from"./room-5b4c6a84.js";import{g as re}from"./roomType-82068446.js";import{a as ne}from"./dict-a540f38d.js";import"./request-7f0efd49.js";const se={class:"page"},me={class:"toolbar"},ie={__name:"RoomList",setup(pe){const B=p([]),w=p([]),x=p([]),k=p([]),m=F({floorId:null,roomTypeId:null,roomStatusId:null,roomNo:""}),S=p(!1),c=p(!1),T=p(null),R=p(!1),U=p(null),u=F({id:null,roomNo:"",floorId:null,roomTypeId:null,roomStatusId:1,roomStatusName:"空房",remark:""}),N=F({roomStatusId:null}),O={roomNo:[{required:!0,message:"请输入房号",trigger:"blur"}],floorId:[{required:!0,message:"请选择楼层",trigger:"change"}],roomTypeId:[{required:!0,message:"请选择房型",trigger:"change"}]};function G(a){return{1:"success",2:"warning",3:"primary",4:"info",5:"danger"}[a]||"info"}async function i(){const a=await oe(m);B.value=a.list||[]}async function P(){const[a,l,r]=await Promise.all([te(),re(),ne()]);w.value=a||[],x.value=(l==null?void 0:l.list)||l||[],k.value=r||[]}function $(a){a?Object.assign(u,{id:a.id,roomNo:a.roomNo,floorId:a.floorId,roomTypeId:a.roomTypeId,roomStatusId:a.roomStatusId,roomStatusName:a.roomStatusName,remark:a.remark}):D(),S.value=!0}function D(){var a;Object.assign(u,{id:null,roomNo:"",floorId:null,roomTypeId:null,roomStatusId:1,roomStatusName:"空房",remark:""}),(a=T.value)==null||a.resetFields()}async function z(){var a;await((a=T.value)==null?void 0:a.validate().catch(()=>{})),R.value=!0;try{await ae(u),C.success("保存成功"),S.value=!1,i()}catch(l){C.error((l==null?void 0:l.message)||"保存失败")}finally{R.value=!1}}function A(a){U.value=a,N.roomStatusId=a.roomStatusId,c.value=!0}async function H(){k.value.find(a=>a.id===N.roomStatusId),await ue(U.value.id,N.roomStatusId),C.success("状态已更新"),c.value=!1,i()}async function J(a){await le.confirm("确定删除该房间吗？","提示",{type:"warning"}),await de(a.id),C.success("删除成功"),i()}return Z(()=>{P(),i()}),(a,l)=>{const r=n("el-button"),v=n("el-option"),b=n("el-select"),L=n("el-input"),I=n("el-table-column"),Q=n("el-tag"),W=n("el-table"),X=n("el-card"),g=n("el-form-item"),E=n("el-form"),q=n("el-dialog");return d(),f("div",se,[o(X,null,{header:t(()=>[l[16]||(l[16]=j("span",null,"房间管理",-1)),o(r,{type:"primary",style:{float:"right"},onClick:l[0]||(l[0]=e=>$())},{default:t(()=>[...l[15]||(l[15]=[s("新增房间",-1)])]),_:1})]),default:t(()=>[j("div",me,[o(b,{modelValue:m.floorId,"onUpdate:modelValue":l[1]||(l[1]=e=>m.floorId=e),placeholder:"楼层",clearable:"",style:{width:"120px"},onChange:i},{default:t(()=>[(d(!0),f(_,null,V(w.value,e=>(d(),y(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o(b,{modelValue:m.roomTypeId,"onUpdate:modelValue":l[2]||(l[2]=e=>m.roomTypeId=e),placeholder:"房型",clearable:"",style:{width:"120px"},onChange:i},{default:t(()=>[(d(!0),f(_,null,V(x.value,e=>(d(),y(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o(b,{modelValue:m.roomStatusId,"onUpdate:modelValue":l[3]||(l[3]=e=>m.roomStatusId=e),placeholder:"状态",clearable:"",style:{width:"120px"},onChange:i},{default:t(()=>[(d(!0),f(_,null,V(k.value,e=>(d(),y(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o(L,{modelValue:m.roomNo,"onUpdate:modelValue":l[4]||(l[4]=e=>m.roomNo=e),placeholder:"房号",clearable:"",style:{width:"120px"},onKeyup:h(i,["enter"])},null,8,["modelValue"]),o(r,{type:"primary",onClick:i},{default:t(()=>[...l[17]||(l[17]=[s("查询",-1)])]),_:1})]),o(W,{data:B.value,border:"",stripe:""},{default:t(()=>[o(I,{prop:"roomNo",label:"房号",width:"80"}),o(I,{prop:"floorName",label:"楼层",width:"80"}),o(I,{prop:"roomTypeName",label:"房型",width:"100"}),o(I,{prop:"roomStatusName",label:"状态",width:"90"},{default:t(({row:e})=>[o(Q,{type:G(e.roomStatusId)},{default:t(()=>[s(K(e.roomStatusName),1)]),_:2},1032,["type"])]),_:1}),o(I,{prop:"remark",label:"备注"}),o(I,{label:"操作",width:"180",fixed:"right"},{default:t(({row:e})=>[o(r,{link:"",type:"primary",onClick:M=>$(e)},{default:t(()=>[...l[18]||(l[18]=[s("编辑",-1)])]),_:1},8,["onClick"]),o(r,{link:"",type:"primary",onClick:M=>A(e)},{default:t(()=>[...l[19]||(l[19]=[s("改状态",-1)])]),_:1},8,["onClick"]),o(r,{link:"",type:"danger",onClick:M=>J(e)},{default:t(()=>[...l[20]||(l[20]=[s("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),o(q,{modelValue:S.value,"onUpdate:modelValue":l[11]||(l[11]=e=>S.value=e),title:u.id?"编辑房间":"新增房间",width:"480px",onClose:D},{footer:t(()=>[o(r,{onClick:l[10]||(l[10]=e=>S.value=!1)},{default:t(()=>[...l[21]||(l[21]=[s("取消",-1)])]),_:1}),o(r,{type:"primary",loading:R.value,onClick:z},{default:t(()=>[...l[22]||(l[22]=[s("确定",-1)])]),_:1},8,["loading"])]),default:t(()=>[o(E,{ref_key:"formRef",ref:T,model:u,rules:O,"label-width":"100px"},{default:t(()=>[o(g,{label:"房号",prop:"roomNo"},{default:t(()=>[o(L,{modelValue:u.roomNo,"onUpdate:modelValue":l[5]||(l[5]=e=>u.roomNo=e),placeholder:"如 101",disabled:!!u.id},null,8,["modelValue","disabled"])]),_:1}),o(g,{label:"楼层",prop:"floorId"},{default:t(()=>[o(b,{modelValue:u.floorId,"onUpdate:modelValue":l[6]||(l[6]=e=>u.floorId=e),placeholder:"请选择",style:{width:"100%"}},{default:t(()=>[(d(!0),f(_,null,V(w.value,e=>(d(),y(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(g,{label:"房型",prop:"roomTypeId"},{default:t(()=>[o(b,{modelValue:u.roomTypeId,"onUpdate:modelValue":l[7]||(l[7]=e=>u.roomTypeId=e),placeholder:"请选择",style:{width:"100%"}},{default:t(()=>[(d(!0),f(_,null,V(x.value,e=>(d(),y(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u.id?(d(),y(g,{key:0,label:"状态",prop:"roomStatusId"},{default:t(()=>[o(b,{modelValue:u.roomStatusId,"onUpdate:modelValue":l[8]||(l[8]=e=>u.roomStatusId=e),placeholder:"请选择",style:{width:"100%"}},{default:t(()=>[(d(!0),f(_,null,V(k.value,e=>(d(),y(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):ee("",!0),o(g,{label:"备注",prop:"remark"},{default:t(()=>[o(L,{modelValue:u.remark,"onUpdate:modelValue":l[9]||(l[9]=e=>u.remark=e),type:"textarea",rows:"2"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),o(q,{modelValue:c.value,"onUpdate:modelValue":l[14]||(l[14]=e=>c.value=e),title:"修改房间状态",width:"360px"},{footer:t(()=>[o(r,{onClick:l[13]||(l[13]=e=>c.value=!1)},{default:t(()=>[...l[23]||(l[23]=[s("取消",-1)])]),_:1}),o(r,{type:"primary",onClick:H},{default:t(()=>[...l[24]||(l[24]=[s("确定",-1)])]),_:1})]),default:t(()=>[o(E,{"label-width":"80px"},{default:t(()=>[o(g,{label:"房号"},{default:t(()=>{var e;return[s(K((e=U.value)==null?void 0:e.roomNo),1)]}),_:1}),o(g,{label:"状态"},{default:t(()=>[o(b,{modelValue:N.roomStatusId,"onUpdate:modelValue":l[12]||(l[12]=e=>N.roomStatusId=e),placeholder:"请选择",style:{width:"100%"}},{default:t(()=>[(d(!0),f(_,null,V(k.value,e=>(d(),y(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},_e=Y(ie,[["__scopeId","data-v-4be62dca"]]);export{_e as default};
